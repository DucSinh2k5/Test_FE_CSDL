<!doctype html>
<html lang="vi">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Admin Dashboard - Qu·∫£n l√Ω B√°n h√†ng (Demo)</title>
    <style>
        :root {
            --bg: #f5f7fb;
            --card: #ffffff;
            --accent: #83ce1a;
            --muted: #5aae10;
            --danger: #ef4444;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: Inter, Segoe UI, Roboto, Arial;
            margin: 0;
            background: var(--bg);
            color: #111;
        }

        /* ---------- HEADER ---------- */
        header {
            background: linear-gradient(90deg, #6d6c86 0%, #6d28d9 100%);
            color: white;
            padding: 18px 24px;
        }

        header h1 {
            margin: 0;
            font-size: 20px;
        }

        /* ---------- CONTAINER ---------- */
        .container {
            max-width: 1400px;
            /* m·ªü r·ªông v√πng hi·ªÉn th·ªã */
            margin: 20px auto;
            padding: 0 16px;
        }

        /* ---------- STATS ---------- */
        .stats {
            display: flex;
            gap: 12px;
            margin: 16px 0;
        }

        .stat {
            background: var(--card);
            border-radius: 10px;
            padding: 12px;
            flex: 1;
            box-shadow: 0 1px 3px rgba(16, 24, 40, 0.05);
        }

        /* ---------- TABS ---------- */
        .tabs {
            display: flex;
            gap: 8px;
            margin: 8px 0;
        }

        .tab {
            background: transparent;
            border: 1px solid transparent;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
        }

        .tab.active {
            background: var(--card);
            border-color: #e6e9f2;
            box-shadow: 0 1px 3px rgba(16, 24, 40, 0.04);
        }

        /* ---------- GRID ---------- */
        .grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
        }

        /* ---------- SECTIONS ---------- */
        section.card {
            background: var(--card);
            padding: 16px;
            border-radius: 10px;
            box-shadow: 0 1px 4px rgba(16, 24, 40, 0.06);
            width: 100%;
        }

        /* L√†m cho c√°c section chi·∫øm to√†n chi·ªÅu ngang */
        #products,
        #customers,
        #orders {
            grid-column: 1 / -1;
            width: 100%;
        }

        /* ---------- FORMS ---------- */
        form.row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            align-items: end;
        }

        form .field {
            flex: 1;
            min-width: 150px;
        }

        label {
            display: block;
            font-size: 13px;
            color: var(--muted);
            margin-bottom: 6px;
        }

        input[type="text"],
        input[type="number"],
        select,
        input[type="date"] {
            width: 100%;
            padding: 8px;
            border-radius: 8px;
            border: 1px solid #e6e9f2;
        }

        button {
            background: var(--accent);
            color: black;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
        }

        button.ghost {
            background: transparent;
            color: var(--muted);
            border: 1px solid #e6e9f2;
        }

        /* ---------- TABLES ---------- */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 12px;
        }

        th,
        td {
            padding: 8px 10px;
            text-align: left;
            border-bottom: 1px solid #eef2ff;
            font-size: 14px;
        }

        th {
            background: transparent;
            color: var(--muted);
            font-weight: 600;
        }

        .actions button {
            margin-right: 6px;
            padding: 6px 8px;
        }

        .search {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .muted {
            color: var(--muted);
            font-size: 15px;
        }

        /* ---------- PRODUCT GRID ---------- */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            /* tƒÉng chi·ªÅu r·ªông */
            gap: 20px;
            width: 100%;
        }

        .product-card {
            background: #fff;
            border-radius: 12px;
            padding: 14px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);
            text-align: center;
            transition: transform 0.2s;
        }

        /* ---------- PRODUCT LAYOUT ---------- */
        .product-layout {
            display: flex;
            gap: 20px;
        }

        /* ---------- FILTER SIDEBAR ---------- */
        .filter-sidebar {
            width: 240px;
            background: var(--card);
            border-radius: 10px;
            padding: 16px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.06);
            height: fit-content;
        }

        .filter-sidebar h3 {
            margin-top: 0;
            font-size: 18px;
            color: var(--accent);
        }

        .filter-group {
            margin-bottom: 16px;
        }

        .filter-group label {
            display: block;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 6px;
            color: var(--muted);
        }

        .filter-group input,
        .filter-group select {
            width: 100%;
            padding: 8px;
            border-radius: 8px;
            border: 1px solid #e6e9f2;
            margin-bottom: 4px;
        }

        /* ---------- PRODUCT LIST AREA ---------- */
        .product-list-area {
            flex: 1;
        }

        /* ---------- RESPONSIVE ---------- */
        @media (max-width: 900px) {
            .product-layout {
                flex-direction: column;
            }

            .filter-sidebar {
                width: 100%;
                order: -1;
            }
        }


        .product-card:hover {
            transform: translateY(-4px);
        }

        .product-card img {
            width: 100%;
            height: 220px;
            object-fit: cover;
            border-radius: 10px;
        }

        .product-card h4 {
            margin: 8px 0 4px;
            font-size: 16px;
        }

        .product-card .price {
            color: #059669;
            font-weight: bold;
            font-size: 15px;
        }

        .product-card .brand {
            font-size: 13px;
            color: gray;
        }

        .product-card button {
            margin-top: 8px;
            padding: 6px 10px;
            border-radius: 6px;
        }

        /* ---------- RESPONSIVE ---------- */
        @media (min-width: 900px) {
            .grid {
                grid-template-columns: 1fr;
            }

            .orders-section {
                grid-column: 1 / -1;
            }
        }
    </style>

</head>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const ADMIN_PASSWORD = "admin123";

        // H√†m x·ª≠ l√Ω logic x√°c th·ª±c & ch·ªânh s·ª≠a
        function handleEditClick(e) {
            const btn = e.target;
            const container = btn.closest(".product-card, tr"); // c√≥ th·ªÉ l√† card ho·∫∑c row
            const pass = prompt("üîí Nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ s·ª≠a s·∫£n ph·∫©m:");

            if (pass === null) return;

            if (pass === ADMIN_PASSWORD) {
                alert("‚úÖ X√°c th·ª±c th√†nh c√¥ng! B·∫°n c√≥ th·ªÉ s·ª≠a s·∫£n ph·∫©m.");

                // N·∫øu l√† card s·∫£n ph·∫©m
                if (container.classList.contains("product-card")) {
                    const nameElem = container.querySelector(".product-name");
                    const priceElem = container.querySelector(".product-price");

                    const oldName = nameElem.textContent.trim();
                    const oldPrice = priceElem.textContent.trim();

                    nameElem.innerHTML = `<input type="text" value="${oldName}">`;
                    priceElem.innerHTML = `<input type="text" value="${oldPrice}">`;

                    btn.textContent = "L∆∞u";
                    btn.classList.add("save-btn");
                    btn.classList.remove("edit-btn");

                    btn.addEventListener("click", function saveCard() {
                        nameElem.textContent = nameElem.querySelector("input").value;
                        priceElem.textContent = priceElem.querySelector("input").value;
                        btn.textContent = "S·ª≠a";
                        btn.classList.remove("save-btn");
                        btn.classList.add("edit-btn");
                        alert("üíæ ƒê√£ l∆∞u thay ƒë·ªïi!");
                        btn.removeEventListener("click", saveCard);
                    }, { once: true });
                }

                // N·∫øu l√† h√†ng trong b·∫£ng
                else if (container.tagName === "TR") {
                    const cells = container.querySelectorAll("td:not(:last-child)");
                    cells.forEach(td => {
                        const oldText = td.textContent;
                        td.innerHTML = `<input type="text" value="${oldText}">`;
                    });

                    btn.textContent = "L∆∞u";
                    btn.classList.add("save-btn");
                    btn.classList.remove("edit-btn");

                    btn.addEventListener("click", function saveRow() {
                        const inputs = container.querySelectorAll("input");
                        inputs.forEach(inp => {
                            const td = inp.parentElement;
                            td.textContent = inp.value;
                        });
                        btn.textContent = "S·ª≠a";
                        btn.classList.remove("save-btn");
                        btn.classList.add("edit-btn");
                        alert("üíæ ƒê√£ l∆∞u thay ƒë·ªïi!");
                        btn.removeEventListener("click", saveRow);
                    }, { once: true });
                }

            } else {
                alert("‚ùå Sai m·∫≠t kh·∫©u! B·∫°n ch·ªâ l√† kh√°ch h√†ng, kh√¥ng th·ªÉ ch·ªânh s·ª≠a.");
            }
        }

        // G·∫Øn s·ª± ki·ªán cho t·∫•t c·∫£ n√∫t "S·ª≠a" tr√™n trang
        document.querySelectorAll(".edit-btn").forEach(btn => {
            btn.addEventListener("click", handleEditClick);
        });
    });
</script>

<body>


    <header style="background: linear-gradient(90deg, #6a5acd, #7b3fe4); padding: 10px 20px;">
        <div class="container" style="display:flex;align-items:center;justify-content:space-between;">
            <div style="display:flex;align-items:center;gap:15px;">
                <img src="logo.png" alt="Logo" style="height:100px;object-fit:contain;">
                <h1 style="color:white;margin:0;font-size:22px;">H·ªÜ TH·ªêNG QU·∫¢N L√ù B√ÅN H√ÄNG</h1>
            </div>
            <div class="muted" style="color:#9fff66;font-size:16px;">
                Ng∆∞·ªùi d√πng: <strong>Admin(demo)</strong>
            </div>
        </div>
    </header>


    <main class="container">
        <div class="stats">
            <div class="stat">
                <div class="muted">T·ªïng s·∫£n ph·∫©m</div>
                <div style="font-size:20px" id="stat-products">0</div>
            </div>
            <div class="stat">
                <div class="muted">T·ªïng kh√°ch h√†ng</div>
                <div style="font-size:20px" id="stat-customers">0</div>
            </div>
            <div class="stat">
                <div class="muted">T·ªïng ƒë∆°n h√†ng</div>
                <div style="font-size:20px" id="stat-orders">0</div>
            </div>
            <div class="stat">
                <div class="muted">Doanh thu (t·ªïng)</div>
                <div style="font-size:20px;color:#059669" id="stat-revenue">0</div>
            </div>
        </div>

        <div class="tabs" role="tablist">
            <button class="tab active" data-target="products">S·∫£n ph·∫©m</button>
            <button class="tab" data-target="customers">Kh√°ch h√†ng</button>
            <button class="tab" data-target="orders">ƒê∆°n h√†ng</button>
        </div>

        <div class="grid">
            <!-- PRODUCTS -->
            <section id="products" class="card">

                <h3>S·∫£n ph·∫©m</h3>
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                    <input id="search-products" type="text" placeholder="T√¨m s·∫£n ph·∫©m..." oninput="renderProducts()"
                        style="flex:1;padding:8px;border-radius:8px;border:1px solid #ccc;margin-right:8px;">
                    <div class="muted">Hi·ªÉn th·ªã <span id="products-count">0</span> s·∫£n ph·∫©m</div>
                </div>
                <div class="product-layout">
                    <!-- Sidebar filter -->
                    <aside class="filter-sidebar">
                        <h3>Filter</h3>

                        <div class="filter-group">
                            <label>Kho·∫£ng gi√° (VNƒê)</label>
                            <input type="number" id="min-price" placeholder="T·ª´" min="0" step="10000">
                            <input type="number" id="max-price" placeholder="ƒê·∫øn" min="0" step="10000">
                        </div>

                        <div class="filter-group">
                            <label>Lo·∫°i h√†ng</label>
                            <select id="filter-category">
                                <option value="">-- T·∫•t c·∫£ --</option>
                                <option value="Th·ªùi trang">Th·ªùi trang</option>
                                <option value="Gi√†y d√©p">Gi√†y d√©p</option>
                                <option value="Ph·ª• ki·ªán">Ph·ª• ki·ªán</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <label>Th∆∞∆°ng hi·ªáu</label>
                            <select id="filter-brand">
                                <option value="">-- T·∫•t c·∫£ --</option>
                                <option value="Louis Vuitton">Louis Vuitton</option>
                                <option value="Routine">Routine</option>
                                <option value="MLB">MLB</option>
                                <option value="Gucci">Gucci</option>
                                <option value="Nike">Nike</option>
                            </select>
                        </div>

                        <button onclick="applyFilters()">L·ªçc</button>
                        <button class="ghost" onclick="resetFilters()">ƒê·∫∑t l·∫°i</button>
                    </aside>

                    <!-- Product list -->
                    <div class="product-list-area">
                        <div class="product-grid" id="product-grid"></div>
                    </div>
                </div>

                <div class="product-grid" id="product-grid"></div>

                <hr style="margin:20px 0;">

                <h4>Th√™m / s·ª≠a s·∫£n ph·∫©m</h4>
                <form id="product-form" class="row" onsubmit="event.preventDefault(); handleProductSubmit()">
                    <div class="field">
                        <label>T√™n s·∫£n ph·∫©m</label>
                        <input type="text" id="p-name" required />
                    </div>
                    <div class="field">
                        <label>Th∆∞∆°ng hi·ªáu</label>
                        <input type="text" id="p-brand" />
                    </div>
                    <div class="field">
                        <label>Lo·∫°i</label>
                        <input type="text" id="p-category" />
                    </div>
                    <div class="field">
                        <label>Gi√° (VNƒê)</label>
                        <input type="number" id="p-price" min="0" step="1000" value="0" />
                    </div>
                    <div class="field">
                        <label>·∫¢nh (URL)</label>
                        <input type="text" id="p-image" placeholder="https://..." />
                    </div>
                    <div class="field">
                        <label>S·ªë l∆∞·ª£ng</label>
                        <input type="number" id="p-stock" min="0" value="0" />
                    </div>
                    <input type="hidden" id="p-id" />
                    <div style="display:flex;gap:8px;align-items:center">
                        <button type="submit">L∆∞u</button>
                        <button type="button" class="ghost" onclick="resetProductForm()">H·ªßy</button>
                    </div>
                </form>


            </section>



            <!-- CUSTOMERS -->
            <section id="customers" class="card" style="display:none">
                <h3>Kh√°ch h√†ng</h3>
                <form id="customer-form" class="row" onsubmit="event.preventDefault(); handleCustomerSubmit()">
                    <div class="field">
                        <label>T√™n kh√°ch</label>
                        <input type="text" id="c-name" required />
                    </div>
                    <div class="field">
                        <label>Email</label>
                        <input type="text" id="c-email" />
                    </div>
                    <div class="field">
                        <label>ƒêi·ªán tho·∫°i</label>
                        <input type="text" id="c-phone" />
                    </div>
                    <input type="hidden" id="c-id" />
                    <div style="display:flex;gap:8px;align-items:center">
                        <button type="submit">L∆∞u</button>
                        <button type="button" class="ghost" onclick="resetCustomerForm()">H·ªßy</button>
                    </div>
                </form>

                <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
                    <div class="search"><input id="search-customers" type="text" placeholder="T√¨m kh√°ch h√†ng..."
                            oninput="renderCustomers()" /></div>
                    <div class="muted">Hi·ªÉn th·ªã <span id="customers-count">0</span> kh√°ch</div>
                </div>

                <div style="overflow:auto;max-height:320px;margin-top:8px">
                    <table id="customers-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>T√™n</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>H√†nh ƒë·ªông</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- ORDERS -->
            <section id="orders" class="card orders-section" style="display:none">
                <h3>ƒê∆°n h√†ng</h3>
                <form id="order-form" class="row" onsubmit="event.preventDefault(); handleOrderSubmit()">
                    <div class="field">
                        <label>Kh√°ch h√†ng</label>
                        <select id="o-customer"></select>
                    </div>
                    <div class="field">
                        <label>S·∫£n ph·∫©m</label>
                        <select id="o-product" onchange="updateOrderPrice()"></select>
                    </div>
                    <div class="field">
                        <label>S·ªë l∆∞·ª£ng</label>
                        <input type="number" id="o-qty" min="1" value="1" onchange="updateOrderPrice()" />
                    </div>
                    <div class="field">
                        <label>Ng√†y</label>
                        <input type="date" id="o-date" />
                    </div>
                    <div class="field">
                        <label>T·ªïng (VNƒê)</label>
                        <input type="text" id="o-total" readonly />
                    </div>
                    <div>
                        <button onclick="saveProduct()" class="save-btn">L∆∞u</button>
                        <button onclick="resetProductForm()" class="ghost">H·ªßy</button>
                    </div>
                    <input type="hidden" id="o-id" />
                    <div style="display:flex;gap:8px;align-items:center">
                        <button type="submit">T·∫°o ƒë∆°n</button>
                        <button type="button" class="ghost" onclick="resetOrderForm()">H·ªßy</button>
                    </div>
                </form>

                <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
                    <div class="search"><input id="search-orders" type="text"
                            placeholder="T√¨m ƒë∆°n... (kh√°ch / s·∫£n ph·∫©m)" oninput="renderOrders()" /></div>
                    <div class="muted">Hi·ªÉn th·ªã <span id="orders-count">0</span> ƒë∆°n</div>
                </div>

                <div style="overflow:auto;max-height:360px;margin-top:8px">
                    <table id="orders-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Kh√°ch</th>
                                <th>S·∫£n ph·∫©m</th>
                                <th>SL</th>
                                <th>Gi√°</th>
                                <th>T·ªïng</th>
                                <th>Ng√†y</th>
                                <th>H√†nh ƒë·ªông</th>
                            </tr>
                        </thead>
                        <tbody>

                        </tbody>
                    </table>
                </div>
            </section>
        </div>
    </main>

    <script>
        // ---------- SAMPLE DATA & STATE ----------
        let products = [
            { id: 1, name: "√Åo thun nam", brand: "Louis Vuitton", category: "Th·ªùi trang", price: 120000, stock: 10, image: "ao_thun.jpg" },
            { id: 2, name: "Qu·∫ßn jean", brand: "Routine", category: "Th·ªùi trang", price: 350000, stock: 8, image: "quan_jean.jpg" },
            { id: 3, name: "Gi√†y sneaker", brand: "MLB", category: "Gi√†y d√©p", price: 450000, stock: 5, image: "giay_sneaker.jpg" },
            { id: 4, name: "M≈© l∆∞·ª°i trai", brand: "MLB", category: "Ph·ª• ki·ªán", price: 150000, stock: 12, image: "mu_luoi_trai.jpg" },
            { id: 5, name: "√Åo kho√°c nam", brand: "Zara", category: "Th·ªùi trang", price: 550000, stock: 7, image: "ao_khoac.jpg" },
            { id: 6, name: "T√∫i x√°ch tay", brand: "Gucci", category: "Ph·ª• ki·ªán", price: 950000, stock: 3, image: "tui_xach.jpg" },
            { id: 7, name: "ƒê·ªìng h·ªì nam", brand: "Tissot", category: "Ph·ª• ki·ªán", price: 1250000, stock: 4, image: "dong_ho.jpg" },
            { id: 8, name: "Tai nghe Bluetooth", brand: "Sony", category: "ƒêi·ªán t·ª≠", price: 780000, stock: 6, image: "tai_nghe.jpg" },
            { id: 9, name: "Balo laptop", brand: "Xiaomi", category: "Ph·ª• ki·ªán", price: 320000, stock: 9, image: "balo.jpg" },
            { id: 10, name: "√Åo s∆° mi n·ªØ", brand: "An Ph∆∞·ªõc", category: "Th·ªùi trang", price: 250000, stock: 15, image: "ao_somi.jpg" }
        ];

        // ---------- HELPERS ----------
        function $(id) { return document.getElementById(id) }
        function formatCurrency(n) { return Number(n).toLocaleString('vi-VN') }

        // ---------- RENDERERS ----------
        function renderProducts() {
            const grid = document.getElementById('product-grid');
            grid.innerHTML = '';
            const q = document.getElementById('search-products').value.toLowerCase();
            const list = products.filter(p =>
                p.name.toLowerCase().includes(q) ||
                (p.category && p.category.toLowerCase().includes(q)) ||
                (p.brand && p.brand.toLowerCase().includes(q))
            );
            list.forEach(p => {
                const card = document.createElement('div');
                card.className = 'product-card';
                card.innerHTML = `
      <img src="${p.image || 'https://via.placeholder.com/150'}" alt="${p.name}">
      <h4>${p.name}</h4>
      <div class="price">${formatCurrency(p.price)} VNƒê</div>
      <div class="brand">${p.brand || ''}</div>
      <div class="muted">${p.category || ''}</div>
      <div style="margin-top:6px">
        <button onclick="startEditProduct(${p.id})">S·ª≠a</button>
        <button onclick="deleteProduct(${p.id})" style="background:var(--danger);color:white">X√≥a</button>
      </div>
    `;
                grid.appendChild(card);
            });
            document.getElementById('products-count').textContent = list.length;
            document.getElementById('stat-products').textContent = products.length;
            updateSummary();
        }
        function applyFilters() {
            const min = Number($('min-price').value) || 0;
            const max = Number($('max-price').value) || Infinity;
            const category = $('filter-category').value;
            const brand = $('filter-brand').value;

            const filtered = products.filter(p => {
                const matchPrice = p.price >= min && p.price <= max;
                const matchCategory = !category || p.category === category;
                const matchBrand = !brand || p.brand === brand;
                return matchPrice && matchCategory && matchBrand;
            });

            renderFilteredProducts(filtered);
        }

        function resetFilters() {
            $('min-price').value = '';
            $('max-price').value = '';
            $('filter-category').value = '';
            $('filter-brand').value = '';
            renderProducts();
        }

        function renderFilteredProducts(list) {
            const grid = $('product-grid');
            grid.innerHTML = '';
            list.forEach(p => {
                grid.innerHTML += `
        <div class="product-card">
            <img src="${p.image}" alt="${p.name}">
            <h4>${p.name}</h4>
            <div class="price">${p.price.toLocaleString()} VND</div>
            <div class="brand">${p.brand}</div>
            <div class="brand">${p.category}</div>
            <button onclick="startEditProduct(${p.id})">S·ª≠a</button>
            <button class="edit-btn">S·ª≠a</button>

            <button class="ghost" style="background:#ef4444;color:white" onclick="deleteProduct(${p.id})">X√≥a</button>
        </div>`;
            });
        }





        function renderCustomers() {
            const tbody = $('customers-table').querySelector('tbody'); tbody.innerHTML = '';
            const q = $('search-customers').value.toLowerCase();
            const list = customers.filter(c => c.name.toLowerCase().includes(q) || c.email.toLowerCase().includes(q) || c.phone.includes(q));
            list.forEach(c => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${c.id}</td><td>${c.name}</td><td>${c.email || '-'}</td><td>${c.phone || '-'}</td>
          <td class="actions"><button onclick="startEditCustomer(${c.id})">S·ª≠a</button><button onclick="deleteCustomer(${c.id})" style="background:var(--danger)">X√≥a</button></td>`;
                tbody.appendChild(tr);
            });
            $('customers-count').textContent = list.length;
            $('stat-customers').textContent = customers.length;
            updateOrderCustomerOptions();
            updateSummary();
        }

        function renderOrders() {
            const tbody = $('orders-table').querySelector('tbody'); tbody.innerHTML = '';
            const q = $('search-orders').value.toLowerCase();
            const list = orders.filter(o => {
                const c = customers.find(x => x.id === o.customerId)?.name.toLowerCase() || '';
                const p = products.find(x => x.id === o.productId)?.name.toLowerCase() || '';
                return c.includes(q) || p.includes(q) || String(o.id) === q;
            });
            list.forEach(o => {
                const customer = customers.find(c => c.id === o.customerId) || { name: '[kh√¥ng x√°c ƒë·ªãnh]' };
                const product = products.find(p => p.id === o.productId) || { name: '[kh√¥ng x√°c ƒë·ªãnh]', price: 0 };
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${o.id}</td><td>${customer.name}</td><td>${product.name}</td><td>${o.qty}</td><td>${formatCurrency(product.price)}</td><td>${formatCurrency(o.total)}</td><td>${o.date}</td>
          <td class="actions"><button onclick="startEditOrder(${o.id})">S·ª≠a</button><button onclick="deleteOrder(${o.id})" style="background:var(--danger)">X√≥a</button></td>`;
                tbody.appendChild(tr);
            });
            $('orders-count').textContent = list.length;
            $('stat-orders').textContent = orders.length;
            updateSummary();
        }

        function updateSummary() {
            const revenue = orders.reduce((s, o) => s + Number(o.total), 0);
            $('stat-revenue').textContent = formatCurrency(revenue);
        }

        // ---------- PRODUCT ACTIONS ----------
        function handleProductSubmit() {
            const id = $('p-id').value.trim();
            const name = $('p-name').value.trim();
            const brand = $('p-brand').value.trim();
            const category = $('p-category').value.trim();
            const price = Number($('p-price').value) || 0;
            const stock = Number($('p-stock').value) || 0;
            const image = $('p-image').value.trim();

            if (!name) return alert('‚ö†Ô∏è Vui l√≤ng nh·∫≠p t√™n s·∫£n ph·∫©m');
            if (price < 0) return alert('‚ö†Ô∏è Gi√° kh√¥ng h·ª£p l·ªá');
            if (stock < 0) return alert('‚ö†Ô∏è S·ªë l∆∞·ª£ng kh√¥ng h·ª£p l·ªá');

            if (id) {
                // --- s·ª≠a s·∫£n ph·∫©m ---
                const p = products.find(x => x.id == id);
                if (p) Object.assign(p, { name, brand, category, price, stock, image });
            } else {
                // --- th√™m s·∫£n ph·∫©m ---
                const newId = products.length ? Math.max(...products.map(p => p.id)) + 1 : 1;
                products.push({ id: newId, name, brand, category, price, stock, image });
            }

            resetProductForm();
            renderProducts();
            updateOrderProductOptions();
        }

        function startEditProduct(id) {
            const ADMIN_PASSWORD = "admin123";
            const pass = prompt("üîí Nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ s·ª≠a s·∫£n ph·∫©m:");

            if (pass === null) return; // b·∫•m Cancel
            if (pass !== ADMIN_PASSWORD) {
                alert("‚ùå Sai m·∫≠t kh·∫©u! B·∫°n kh√¥ng c√≥ quy·ªÅn ch·ªânh s·ª≠a s·∫£n ph·∫©m.");
                return;
            }

            // N·∫øu ƒë√∫ng m·∫≠t kh·∫©u ‚Üí cho ph√©p ch·ªânh s·ª≠a
            const p = products.find(x => x.id === id);
            if (!p) return;
            $('p-id').value = p.id;
            $('p-name').value = p.name;
            $('p-brand').value = p.brand;
            $('p-category').value = p.category;
            $('p-price').value = p.price;
            $('p-image').value = p.image;
            $('p-stock').value = p.stock;
            alert("‚úÖ X√°c th·ª±c th√†nh c√¥ng! B·∫°n c√≥ th·ªÉ s·ª≠a s·∫£n ph·∫©m.");
        }


        function resetProductForm() {
            $('p-id').value = '';
            $('p-name').value = '';
            $('p-brand').value = '';
            $('p-category').value = '';
            $('p-price').value = 0;
            $('p-stock').value = 0;
            $('p-image').value = '';
        }

        // ---------- CUSTOMER ACTIONS ----------
        function handleCustomerSubmit() {
            const id = $('c-id').value;
            const name = $('c-name').value.trim(); const email = $('c-email').value.trim(); const phone = $('c-phone').value.trim();
            if (!name) return alert('Nh·∫≠p t√™n kh√°ch h√†ng');
            if (id) { const c = customers.find(x => x.id == id); Object.assign(c, { name, email, phone }); }
            else { customerId++; customers.push({ id: customerId, name, email, phone }); }
            resetCustomerForm(); renderCustomers();
        }
        function startEditCustomer(id) { const c = customers.find(x => x.id === id); if (!c) return; $('c-id').value = c.id; $('c-name').value = c.name; $('c-email').value = c.email; $('c-phone').value = c.phone; scrollToElement('customers'); }
        function deleteCustomer(id) { if (!confirm('X√≥a kh√°ch h√†ng?')) return; const idx = customers.findIndex(x => x.id === id); if (idx >= 0) customers.splice(idx, 1); renderCustomers(); renderOrders(); }
        function resetCustomerForm() { $('c-id').value = ''; $('c-name').value = ''; $('c-email').value = ''; $('c-phone').value = ''; }

        // ---------- ORDER ACTIONS ----------
        function updateOrderCustomerOptions() {
            const sel = $('o-customer'); if (!sel) return; sel.innerHTML = ''; customers.forEach(c => { const opt = document.createElement('option'); opt.value = c.id; opt.textContent = `${c.name} (${c.phone || c.email || '-'})`; sel.appendChild(opt); });
        }
        function updateOrderProductOptions() {
            const sel = $('o-product'); if (!sel) return; sel.innerHTML = ''; products.forEach(p => { const opt = document.createElement('option'); opt.value = p.id; opt.textContent = `${p.name} ‚Äî ${formatCurrency(p.price)}`; sel.appendChild(opt); }); updateOrderPrice();
        }
        function updateOrderPrice() {
            const pid = Number($('o-product').value); const qty = Number($('o-qty').value) || 1; const p = products.find(x => x.id === pid) || { price: 0 }; $('o-total').value = formatCurrency(p.price * qty);
        }
        function handleOrderSubmit() {
            const id = $('o-id').value; const customerIdVal = Number($('o-customer').value); const productIdVal = Number($('o-product').value); const qty = Number($('o-qty').value) || 1; const date = $('o-date').value || new Date().toISOString().slice(0, 10);
            const product = products.find(p => p.id === productIdVal);
            if (!product) return alert('Ch·ªçn s·∫£n ph·∫©m h·ª£p l·ªá');
            if (!customerIdVal) return alert('Ch·ªçn kh√°ch h√†ng');
            const total = product.price * qty;
            if (id) { const o = orders.find(x => x.id == id); Object.assign(o, { customerId: customerIdVal, productId: productIdVal, qty, total, date }); }
            else { orderId++; orders.push({ id: orderId, customerId: customerIdVal, productId: productIdVal, qty, total, date }); }
            resetOrderForm(); renderOrders();
        }
        function startEditOrder(id) { const o = orders.find(x => x.id === id); if (!o) return; $('o-id').value = o.id; $('o-customer').value = o.customerId; $('o-product').value = o.productId; $('o-qty').value = o.qty; $('o-date').value = o.date; updateOrderPrice(); scrollToElement('orders'); }
        function deleteOrder(id) { if (!confirm('X√≥a ƒë∆°n h√†ng?')) return; const idx = orders.findIndex(x => x.id === id); if (idx >= 0) orders.splice(idx, 1); renderOrders(); }
        function resetOrderForm() { $('o-id').value = ''; $('o-customer').selectedIndex = 0; $('o-product').selectedIndex = 0; $('o-qty').value = 1; $('o-date').value = ''; updateOrderPrice(); }

        // ---------- TAB NAV ----------
        document.querySelectorAll('.tab').forEach(btn => btn.addEventListener('click', () => {
            document.querySelectorAll('.tab').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            const target = btn.dataset.target;
            ['products', 'customers', 'orders'].forEach(id => { const el = $(id); el.style.display = (id === target) ? 'block' : 'none'; });
            // focus first input
            setTimeout(() => { const first = document.querySelector(`#${target} form .field input, #${target} form .field select`); if (first) first.focus(); }, 100);
        }));

        function scrollToElement(id) { const el = $(id); if (!el) return; el.scrollIntoView({ behavior: 'smooth', block: 'start' }); }

        // ---------- INIT ----------
        function init() { renderProducts(); renderCustomers(); renderOrders(); updateOrderCustomerOptions(); updateOrderProductOptions(); updateOrderPrice(); }
        init();
        const ADMIN_PASSWORD = "admin123";

        // G·∫Øn s·ª± ki·ªán cho n√∫t "S·ª≠a"
        document.addEventListener("DOMContentLoaded", () => {
            const editButtons = document.querySelectorAll(".edit-btn");

            editButtons.forEach(button => {
                button.addEventListener("click", (event) => {
                    const productRow = event.target.closest("tr");
                    const productName = productRow.querySelector("td:first-child").textContent;

                    // Hi·ªÉn th·ªã popup y√™u c·∫ßu m·∫≠t kh·∫©u
                    const password = prompt(`üîí Nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ s·ª≠a s·∫£n ph·∫©m "${productName}":`);

                    if (password === null) return; // Ng∆∞·ªùi d√πng nh·∫•n Cancel
                    if (password === ADMIN_PASSWORD) {
                        alert("‚úÖ X√°c th·ª±c th√†nh c√¥ng! B·∫°n c√≥ th·ªÉ ch·ªânh s·ª≠a s·∫£n ph·∫©m n√†y.");

                        // Cho ph√©p s·ª≠a: v√≠ d·ª• b·∫≠t ch·∫ø ƒë·ªô editable
                        const cells = productRow.querySelectorAll("td");
                        cells.forEach((cell, index) => {
                            if (index < cells.length - 1) { // b·ªè c·ªôt h√†nh ƒë·ªông
                                const input = document.createElement("input");
                                input.value = cell.textContent;
                                cell.textContent = "";
                                cell.appendChild(input);
                            }
                        });

                        // Thay n√∫t S·ª≠a -> L∆∞u
                        event.target.textContent = "L∆∞u";
                        event.target.classList.add("save-btn");
                        event.target.classList.remove("edit-btn");

                        // Khi nh·∫•n L∆∞u
                        event.target.addEventListener("click", () => {
                            const inputs = productRow.querySelectorAll("input");
                            inputs.forEach((input, i) => {
                                const td = input.parentElement;
                                td.textContent = input.value;
                            });

                            event.target.textContent = "S·ª≠a";
                            event.target.classList.remove("save-btn");
                            event.target.classList.add("edit-btn");

                            alert("üíæ ƒê√£ l∆∞u thay ƒë·ªïi!");
                        }, { once: true });

                    } else {
                        alert("‚ùå Sai m·∫≠t kh·∫©u! B·∫°n ch·ªâ l√† kh√°ch h√†ng, kh√¥ng th·ªÉ ch·ªânh s·ª≠a.");
                    }
                });
            });
        });
    </script>

</body>

</html>