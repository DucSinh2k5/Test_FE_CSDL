// Role-based Frontend (React + Tailwind)
// How to use:
// 1. Create a React project (Vite recommended): `npm create vite@latest my-app --template react`
// 2. Install Tailwind CSS following Tailwind docs for React (or use any CSS you like). The code below uses Tailwind
classes.
// 3. Replace src/App.jsx with this file, then run `npm install` and `npm run dev`.

import React, { useState, useEffect } from "react";

// === Demo credentials (only for frontend demo) ===
// admin: admin@example.com / password: admin123
// user: user@example.com / password: user123
// NOTE: In a real app you must authenticate on the server and never store credentials in client code.

const CREDENTIALS = [
{ email: "admin@example.com", password: "admin123", role: "admin", name: "Administrator" },
{ email: "user@example.com", password: "user123", role: "user", name: "Người Dùng" },
];

function Login({ onLogin }) {
const [email, setEmail] = useState("");
const [password, setPassword] = useState("");
const [error, setError] = useState("");

function handleSubmit(e) {
e.preventDefault();
setError("");
const found = CREDENTIALS.find(
(c) => c.email.toLowerCase() === email.toLowerCase() && c.password === password
);
if (found) {
onLogin({ email: found.email, role: found.role, name: found.name });
} else {
setError("Sai email hoặc mật khẩu. Hãy thử: admin@example.com / admin123 hoặc user@example.com / user123");
}
}

return (
<div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100 p-6">
    <div className="w-full max-w-md bg-white rounded-2xl shadow-lg p-8">
        <h1 className="text-2xl font-semibold mb-4">Đăng nhập</h1>
        <form onSubmit={handleSubmit} className="space-y-4">
            <div>
                <label className="block text-sm font-medium mb-1">Email</label>
                <input type="email" required value={email} onChange={(e)=> setEmail(e.target.value)}
                className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-300"
                placeholder="email@example.com"
                />
            </div>
            <div>
                <label className="block text-sm font-medium mb-1">Mật khẩu</label>
                <input type="password" required value={password} onChange={(e)=> setPassword(e.target.value)}
                className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-300"
                placeholder="mật khẩu"
                />
            </div>

            {error && <div className="text-red-600 text-sm">{error}</div>}

            <div className="flex items-center justify-between">
                <button type="submit"
                    className="px-4 py-2 rounded-lg bg-sky-600 text-white font-medium shadow-sm hover:bg-sky-700">
                    Đăng nhập
                </button>

                <button type="button" onClick={()=> {
                    // quick demo helpers
                    setEmail("admin@example.com");
                    setPassword("admin123");
                    }}
                    className="text-sm text-slate-500 hover:underline"
                    >
                    Điền demo admin
                </button>
            </div>
        </form>

        <p className="mt-4 text-xs text-slate-500">Demo accounts: admin@example.com / admin123 · user@example.com /
            user123</p>
    </div>
</div>
);
}

function AdminDashboard({ user, onLogout }) {
const [secretData, setSecretData] = useState("Đang tải...");

useEffect(() => {
// Demo: pretend to fetch admin-only data (client-only)
const t = setTimeout(() => setSecretData("Dữ liệu quản trị: thống kê, quản lý sản phẩm, báo cáo"), 500);
return () => clearTimeout(t);
}, []);

return (
<div className="min-h-screen bg-slate-50 p-8">
    <div className="max-w-5xl mx-auto">
        <header className="flex items-center justify-between mb-6">
            <h2 className="text-2xl font-semibold">Admin Dashboard</h2>
            <div className="flex items-center gap-3">
                <div className="text-sm text-slate-600">Xin chào, {user.name} ({user.email})</div>
                <button onClick={onLogout} className="px-3 py-1 rounded-lg border hover:bg-white/30">
                    Đăng xuất
                </button>
            </div>
        </header>

        <section className="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div className="p-4 rounded-xl bg-white shadow">{secretData}</div>
            <div className="p-4 rounded-xl bg-white shadow">Quản lý người dùng (Demo)</div>
            <div className="p-4 rounded-xl bg-white shadow">Cài đặt hệ thống</div>
        </section>

        <section className="mt-6 bg-white p-4 rounded-xl shadow">
            <h3 className="font-medium mb-2">Chỉnh sửa sản phẩm (chỉ admin)</h3>
            <AdminEditor />
        </section>
    </div>
</div>
);
}

function AdminEditor() {
const [title, setTitle] = useState("Áo thun demo");
const [price, setPrice] = useState(120000);
const [message, setMessage] = useState("");

function handleSave() {
// Demo save: no backend — just show a confirmation
setMessage(`Đã lưu: ${title} — ${price.toLocaleString()} VND`);
setTimeout(() => setMessage(""), 3000);
}

return (
<div className="space-y-3">
    <div className="flex gap-2">
        <input value={title} onChange={(e)=> setTitle(e.target.value)} className="flex-1 px-3 py-2 border rounded-lg" />
        <input type="number" value={price} onChange={(e)=> setPrice(Number(e.target.value))} className="w-40 px-3 py-2
        border rounded-lg" />
    </div>
    <div className="flex gap-2">
        <button onClick={handleSave} className="px-4 py-2 rounded-lg bg-sky-600 text-white">Lưu</button>
        <button onClick={()=> { setTitle("Áo thun demo"); setPrice(120000); }} className="px-4 py-2 rounded-lg
            border">Hủy</button>
    </div>
    {message && <div className="text-green-600 text-sm">{message}</div>}
</div>
);
}

function UserDashboard({ user, onLogout }) {
return (
<div className="min-h-screen bg-gradient-to-b from-white to-slate-50 p-8">
    <div className="max-w-4xl mx-auto">
        <header className="flex items-center justify-between mb-6">
            <h2 className="text-2xl font-semibold">Trang Người Dùng</h2>
            <div className="flex items-center gap-3">
                <div className="text-sm text-slate-600">Xin chào, {user.name}</div>
                <button onClick={onLogout} className="px-3 py-1 rounded-lg border">Đăng xuất</button>
            </div>
        </header>

        <main className="bg-white p-6 rounded-xl shadow">
            <h3 className="font-medium mb-3">Nội dung dành cho người dùng</h3>
            <p className="text-sm text-slate-600">Ở đây bạn có thể hiển thị danh sách sản phẩm, giỏ hàng, profile, v.v.
            </p>

            <div className="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div className="p-4 rounded-lg border">Sản phẩm A</div>
                <div className="p-4 rounded-lg border">Sản phẩm B</div>
            </div>
        </main>
    </div>
</div>
);
}

export default function App() {
// Keep simple client-only "session" in local state (and localStorage for persistence)
const [user, setUser] = useState(() => {
try {
return JSON.parse(localStorage.getItem("demo_user")) || null;
} catch {
return null;
}
});

useEffect(() => {
if (user) localStorage.setItem("demo_user", JSON.stringify(user));
else localStorage.removeItem("demo_user");
}, [user]);

function handleLogin(u) {
setUser(u);
}

function handleLogout() {
setUser(null);
}

// If not logged in -> show login
if (!user) return
<Login onLogin={handleLogin} />;

// Role-based pages
if (user.role === "admin") {
return
<AdminDashboard user={user} onLogout={handleLogout} />;
}

return
<UserDashboard user={user} onLogout={handleLogout} />;
}